<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <title>Plex Newsletter Setup</title>
  <link rel="stylesheet" href="/static/style.css">
</head>
<body>
  <div class="container">
    <h1>ðŸ“¬ Plex Newsletter Setup</h1>
    {% with messages = get_flashed_messages(with_categories=true) %}
      {% for cat, msg in messages %}
        <div class="msg {{ cat }}">{{ msg }}</div>
      {% endfor %}
    {% endwith %}
    <form method="POST">
      {% for field in ['tautulli_url','tautulli_key','email_from','email_pass','email_to','smtp_server','smtp_port'] %}
        <label>{{ field.replace('_',' ').title() }}</label>
        <input type="{{ 'password' if 'pass' in field else 'text' }}" name="{{ field }}" required value="{{ cfg.get(field,'') }}">
      {% endfor %}
      <button type="submit">Save Configuration</button>
    </form>
    <form action="/test-email" method="get">
      <button type="submit">Send Test Email</button>
    </form>
  </div>
</body>
</html>

